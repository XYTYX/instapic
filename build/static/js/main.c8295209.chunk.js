(this.webpackJsonpinstapic=this.webpackJsonpinstapic||[]).push([[0],{138:function(e,t,n){e.exports=n(254)},143:function(e,t,n){},144:function(e,t,n){},254:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),u=n(19),s=n.n(u),i=(n(143),n(20)),o=n.n(i),l=n(36),p=n(58),h=n(30),b=n(8),m=n(90),f=n(258),v=n(257),E=n(259),j=n(46),O=n(47),d=n(48),w=n(37),k=n(81),y=function(){function e(t,n){Object(w.a)(this,e),this._baseUrl=void 0,this._authToken=void 0,this._baseUrl=t,this._authToken=n}return Object(k.a)(e,[{key:"setAuthToken",value:function(e){this._authToken=e}},{key:"doPost",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doFetch(t,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"doGet",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null===n?t:t+"?"+this.encodeQueryParams(n),e.abrupt("return",this.doFetch(this._baseUrl+a,{headers:{Authorization:this._authToken}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"encodeQueryParams",value:function(e){return Object.keys(e).map((function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))})).join("&")}},{key:"doFetch",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,n);case 3:a=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:if(400!==a.status){e.next=13;break}throw new x;case 13:if(401!==a.status){e.next=17;break}throw new _;case 17:if(404!==a.status){e.next=21;break}throw new S;case 21:if(500!==a.status){e.next=23;break}throw new T;case 23:return e.abrupt("return",a);case 24:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),x=function(e){Object(j.a)(n,e);var t=Object(O.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return n}(Object(d.a)(Error)),g=function(e){Object(j.a)(n,e);var t=Object(O.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return n}(Object(d.a)(Error)),_=function(e){Object(j.a)(n,e);var t=Object(O.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return n}(Object(d.a)(Error)),S=function(e){Object(j.a)(n,e);var t=Object(O.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return n}(Object(d.a)(Error)),T=function(e){Object(j.a)(n,e);var t=Object(O.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return n}(Object(d.a)(Error)),P=function(){function e(t){Object(w.a)(this,e),this._client=void 0,this._client=t}return Object(k.a)(e,[{key:"setClient",value:function(e){this._client=e}},{key:"login",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/v1/auth/login",e.prev=1,e.next=4,this._client.doPost("/v1/auth/login",{email:t,password:n});case 4:return a=e.sent,e.abrupt("return",a.json());case 8:e.prev=8,e.t0=e.catch(1),e.t1=e.t0,e.next=e.t1===e.t0 instanceof _?13:e.t1===e.t0 instanceof T?14:15;break;case 13:throw new A;case 14:throw new I;case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"signup",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n,a){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/v1/user",e.prev=1,e.next=4,this._client.doPost("/v1/user",{email:t,username:n,password:a});case 4:return r=e.sent,e.abrupt("return",r.json());case 8:e.prev=8,e.t0=e.catch(1),e.t1=e.t0,e.next=e.t1===e.t0 instanceof g?13:14;break;case 13:throw new C;case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"getPosts",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={sort_by:t},e.prev=1,e.next=4,this._client.doGet("/v1/post",a);case 4:return n=e.sent,e.abrupt("return",n.json());case 8:throw e.prev=8,e.t0=e.catch(1),e.t0;case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),A=function(e){Object(j.a)(n,e);var t=Object(O.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return n}(Object(d.a)(Error)),I=function(e){Object(j.a)(n,e);var t=Object(O.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return n}(Object(d.a)(Error)),C=function(e){Object(j.a)(n,e);var t=Object(O.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return n}(Object(d.a)(Error));n(144);function F(){var e=Object(h.a)();return c.a.createElement("div",{className:"App"},c.a.createElement(b.c,{history:e},c.a.createElement(R,null)))}function R(){var e=Object(r.useState)(""),t=Object(p.a)(e,2),n=t[0],a=t[1],u=Object(r.useRef)(new y("http://serv.instapic.site/",n)),s=Object(r.useRef)(new P(u.current));return Object(r.useEffect)((function(){u.current.setAuthToken(n),s.current.setClient(u.current)}),[n]),c.a.createElement("div",{className:"App"},c.a.createElement("nav",null,c.a.createElement("ul",null,!n&&c.a.createElement(c.a.Fragment,null,c.a.createElement("li",null,c.a.createElement(m.a,{to:"/login"},"Login")),c.a.createElement("li",null,c.a.createElement(m.a,{to:"/signup"},"Signup"))),n&&c.a.createElement("li",null,c.a.createElement(m.a,{to:"/explore"},"Explore")))),c.a.createElement(b.d,null,c.a.createElement(b.b,{path:"/login"},n?c.a.createElement(b.a,{to:"/"}):c.a.createElement(N,{api:s.current,setAuthToken:a})),c.a.createElement(b.b,{path:"/signup"},n?c.a.createElement(b.a,{to:"/"}):c.a.createElement(z,{api:s.current,setAuthToken:a})),c.a.createElement(b.b,{path:"/explore"},n?c.a.createElement(U,{api:s.current}):c.a.createElement(b.a,{to:"login"})),c.a.createElement(b.b,{path:"/"},n?c.a.createElement(U,{api:s.current}):c.a.createElement(b.a,{to:"login"}))))}function U(e){var t=Object(r.useState)(!1),n=Object(p.a)(t,2),u=(n[0],n[1],Object(r.useState)(null)),s=Object(p.a)(u,2),i=s[0],h=s[1],b=Object(r.useState)(a.MOST_RECENT),m=Object(p.a)(b,2),v=m[0];m[1];return Object(r.useEffect)((function(){function t(){return(t=Object(l.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.api.getPosts(v);case 2:n=t.sent,h(n);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[v]),c.a.createElement("div",null,c.a.createElement("h2",null,"Explore"),function(e){if(null!==e)return console.log(e),c.a.createElement(c.a.Fragment,null,e.map((function(e,t){return c.a.createElement(f.a,{key:t,title:e.text},e.created_on)})))}(i))}function N(e){var t=Object(r.useState)(""),n=Object(p.a)(t,2),a=(n[0],n[1]);function u(){return(u=Object(l.a)(o.a.mark((function t(n){var r,c,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.email,c=n.password,t.prev=1,t.next=4,e.api.login(r,c);case 4:u=t.sent,e.setAuthToken(u.authorization),t.next=17;break;case 8:t.prev=8,t.t0=t.catch(1),t.t1=t.t0,t.next=t.t1===t.t0 instanceof A?13:t.t1===t.t0 instanceof I?15:17;break;case 13:return a("Login unsuccessful, check your email and password. Did you mean to sign up?"),t.abrupt("break",17);case 15:return a("Our systems seem to be experiencing issues, please try again later"),t.abrupt("break",17);case 17:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}return c.a.createElement("div",null,c.a.createElement("h2",null,"Login"),c.a.createElement(v.a,{onFinish:function(e){return u.apply(this,arguments)}},c.a.createElement(v.a.Item,{label:"Email",name:"email"},c.a.createElement(E.a,{required:!0})),c.a.createElement(v.a.Item,{label:"Password",name:"password"},c.a.createElement(E.a.Password,{required:!0})),c.a.createElement("button",null,"Submit")))}function z(e){var t=Object(r.useState)(""),n=Object(p.a)(t,2),a=(n[0],n[1]);function u(){return(u=Object(l.a)(o.a.mark((function t(n){var r,c,u,s,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.email,c=n.username,u=n.password,t.prev=1,t.next=4,e.api.signup(r,c,u);case 4:s=t.sent,e.setAuthToken(null===(i=s)||void 0===i?void 0:i.authorization),t.next=16;break;case 8:t.prev=8,t.t0=t.catch(1),t.t1=t.t0,t.next=t.t1===t.t0 instanceof C?13:15;break;case 13:return a("Email is already registered, did you mean to log in?"),t.abrupt("break",16);case 15:throw t.t0;case 16:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}return c.a.createElement("div",null,c.a.createElement("h2",null,"Sign up"),c.a.createElement(v.a,{onFinish:function(e){return u.apply(this,arguments)}},c.a.createElement(v.a.Item,{label:"Email",name:"email"},c.a.createElement(E.a,null)),c.a.createElement(v.a.Item,{label:"Username",name:"username"},c.a.createElement(E.a,null)),c.a.createElement(v.a.Item,{label:"Password",name:"password"},c.a.createElement(E.a.Password,null)),c.a.createElement("button",null,"Submit")))}!function(e){e.MOST_RECENT="most_recent",e.BY_USER="by_user"}(a||(a={}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[138,1,2]]]);
//# sourceMappingURL=main.c8295209.chunk.js.map