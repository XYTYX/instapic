(this.webpackJsonpinstapic=this.webpackJsonpinstapic||[]).push([[0],{141:function(e,t,a){},202:function(e,t,a){e.exports=a(378)},207:function(e,t,a){},378:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),s=a(15),o=a.n(s),u=(a(207),a(19)),i=a.n(u),l=a(36),p=a(55),m=a(44),h=a(16),f=a(92),b=a(59),v=a(389),d=a(384),E=a(382),O=a(386),j=a(385),w=a(388),k=a(383),g=a(387),y=a(60),x=a(61),S=a(62),T=a(50),_=a(104),P=a(83),N=a(199),C=function(){function e(t){Object(T.a)(this,e),this._authToken=void 0,this._authToken=t}return Object(_.a)(e,[{key:"setAuthToken",value:function(e){this._authToken=e}},{key:"doPostFormData",value:function(){var e=Object(l.a)(i.a.mark((function e(t,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doFetch(t,{method:"POST",body:a}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"doPostJson",value:function(){var e=Object(l.a)(i.a.mark((function e(t,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doFetch(t,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(a)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"doGet",value:function(){var e=Object(l.a)(i.a.mark((function e(t,a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null===a?t:t+"?"+this.encodeQueryParams(a),e.abrupt("return",this.doFetch(n,{headers:{Authorization:this._authToken}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"encodeQueryParams",value:function(e){return Object.keys(e).map((function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))})).join("&")}},{key:"doFetch",value:function(){var e=Object(l.a)(i.a.mark((function e(t,a){var n,r,c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.headers,r=Object(N.a)(a,["headers"]),c=Object(P.a)({},n),this._authToken&&(c=Object(P.a)(Object(P.a)({},n),{},{Authorization:"Bearer ".concat(this._authToken)})),e.prev=3,e.next=6,fetch("/api"+t,Object(P.a)(Object(P.a)({},r),{},{headers:c}));case 6:s=e.sent,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(3),e.t0;case 12:if(400!==s.status){e.next=16;break}throw new F;case 16:if(401!==s.status){e.next=20;break}throw new I;case 20:if(404!==s.status){e.next=24;break}throw new M;case 24:if(500!==s.status){e.next=26;break}throw new A;case 26:return e.abrupt("return",s);case 27:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),F=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return a}(Object(S.a)(Error)),R=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return a}(Object(S.a)(Error)),I=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return a}(Object(S.a)(Error)),M=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return a}(Object(S.a)(Error)),A=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return a}(Object(S.a)(Error)),B=function(){function e(t){Object(T.a)(this,e),this._client=void 0,this._client=t}return Object(_.a)(e,[{key:"setClient",value:function(e){this._client=e}},{key:"logout",value:function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/v1/auth/logout",e.prev=1,e.next=4,this._client.doPostJson("/v1/auth/logout",{});case 4:e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),e.t0;case 10:return e.abrupt("return");case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"newPost",value:function(){var e=Object(l.a)(i.a.mark((function e(t,a){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/v1/post",(r=new FormData).append("file",t),r.append("text",a),e.prev=4,e.next=7,this._client.doPostFormData("/v1/post",r);case 7:n=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(4),e.t0;case 13:return e.abrupt("return",n.json());case 14:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(l.a)(i.a.mark((function e(t,a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/v1/auth/login",e.prev=1,e.next=4,this._client.doPostJson("/v1/auth/login",{email:t,password:a});case 4:return n=e.sent,e.abrupt("return",n.json());case 8:e.prev=8,e.t0=e.catch(1),e.t1=e.t0,e.next=e.t1===e.t0 instanceof I?13:e.t1===e.t0 instanceof A?14:15;break;case 13:throw new U;case 14:throw new J;case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"signup",value:function(){var e=Object(l.a)(i.a.mark((function e(t,a,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/v1/user",e.prev=1,e.next=4,this._client.doPostJson("/v1/user",{email:t,username:a,password:n});case 4:return r=e.sent,e.abrupt("return",r.json());case 8:e.prev=8,e.t0=e.catch(1),e.t1=e.t0,e.next=e.t1===e.t0 instanceof R?13:14;break;case 13:throw new L;case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"getPosts",value:function(){var e=Object(l.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={sort_by:t},e.prev=1,e.next=4,this._client.doGet("/v1/post",n);case 4:return a=e.sent,e.abrupt("return",a.json());case 8:throw e.prev=8,e.t0=e.catch(1),e.t0;case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),U=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return a}(Object(S.a)(Error)),J=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return a}(Object(S.a)(Error)),L=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return a}(Object(S.a)(Error)),q=a(390),z=a(391),D=(a(141),a(101)),Y=a.n(D),G=a(175),Q=a(195),W=a.n(Q);function $(){var e=Object(m.a)();return c.a.createElement("div",{className:"App"},c.a.createElement(h.c,{history:e},c.a.createElement(H,null)))}function H(){var e=Object(r.useState)(""),t=Object(p.a)(e,2),a=t[0],n=t[1],s=Object(r.useState)([]),o=Object(p.a)(s,2),u=o[0],m=o[1],v=Object(r.useRef)(new C(a)),d=Object(r.useRef)(new B(v.current)),E=Object(r.useState)(!1),O=Object(p.a)(E,2),j=O[0],w=O[1];function k(e){return g.apply(this,arguments)}function g(){return(g=Object(l.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.current.getPosts(t);case 2:a=e.sent,m(a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.current.logout();case 2:n("");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){v.current.setAuthToken(a),d.current.setClient(v.current)}),[a]),c.a.createElement("div",{className:"App"},c.a.createElement("p",{className:"spaced"}),c.a.createElement("nav",null,!a&&c.a.createElement(c.a.Fragment,null,c.a.createElement(f.a,{to:"/login"},c.a.createElement(b.a,null,"Login")),c.a.createElement(f.a,{to:"/signup"},c.a.createElement(b.a,null,"Signup"))),a&&c.a.createElement(c.a.Fragment,null,c.a.createElement(f.a,{to:"/explore"},c.a.createElement(b.a,null,"Explore")),c.a.createElement(f.a,{to:"new_post"},c.a.createElement(b.a,{onClick:function(){w(!0)}},"New Post"),c.a.createElement(K,{getPosts:k,hideModal:function(){w(!1)},visible:j,api:d.current})),c.a.createElement(b.a,{onClick:function(){return y.apply(this,arguments)}},"Log Out"))),c.a.createElement(h.d,null,c.a.createElement(h.b,{path:"/login"},a?c.a.createElement(h.a,{to:"/"}):c.a.createElement(X,{api:d.current,setAuthToken:n})),c.a.createElement(h.b,{path:"/signup"},a?c.a.createElement(h.a,{to:"/"}):c.a.createElement(Z,{api:d.current,setAuthToken:n})),c.a.createElement(h.b,{path:"/explore"},a?c.a.createElement(V,{posts:u,getPosts:k,api:d.current}):c.a.createElement(h.a,{to:"login"})),c.a.createElement(h.b,{path:"/"},a?c.a.createElement(V,{posts:u,getPosts:k,api:d.current}):c.a.createElement(h.a,{to:"login"}))))}function K(e){var t=Object(r.useState)([]),a=Object(p.a)(t,2),s=a[0],o=a[1],u=Object(r.useState)(!1),m=Object(p.a)(u,2),h=m[0],f=m[1],j=Object(G.useForm)(),w=Object(p.a)(j,1)[0];return c.a.createElement(Y.a,{title:"New Post",visible:e.visible,onCancel:e.hideModal,okText:"Submit",okButtonProps:{disabled:0===s.length},onOk:function(){w.validateFields().then(function(){var t=Object(l.a)(i.a.mark((function t(a){var r,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.file,c=a.text,console.log(a),f(!0),t.prev=4,t.next=7,e.api.newPost(r.file.originFileObj,c);case 7:t.sent,t.next=12;break;case 10:t.prev=10,t.t0=t.catch(4);case 12:return f(!1),e.hideModal(),t.prev=14,t.next=17,e.getPosts(n.MOST_RECENT);case 17:t.next=21;break;case 19:t.prev=19,t.t1=t.catch(14);case 21:case"end":return t.stop()}}),t,null,[[4,10],[14,19]])})));return function(e){return t.apply(this,arguments)}}())},confirmLoading:h},c.a.createElement(d.a,{form:w,preserve:!1,name:"validate_other"},c.a.createElement(d.a.Item,{name:"file",label:"Image",extra:"Please upload a .png, .jpg, .jpeg, or .gif image"},c.a.createElement(E.a,{customRequest:function(e){var t=e.onSuccess;setTimeout((function(){t("ok")}),0)},onChange:function(e){var t=[];switch(e.file.status){case"uploading":case"done":t=[e.file];break;default:t=[]}o(t)},fileList:s,name:"logo",listType:"picture",beforeUpload:function(e){return!!["image/png","image/jpg","image/jpeg","image/gif"].includes(e.type)||(v.b.error("".concat(e.name," is not in a file format that we support")),!1)}},c.a.createElement(b.a,{icon:c.a.createElement(q.a,null)},"Click to upload"))),c.a.createElement(d.a.Item,{name:"text",label:"Subtitle"},c.a.createElement(O.a,{required:!0}))))}function V(e){var t=Object(r.useState)(null),a=Object(p.a)(t,2),s=(a[0],a[1],Object(r.useState)(n.MOST_RECENT)),o=Object(p.a)(s,2),u=o[0],i=o[1];return Object(r.useEffect)((function(){e.getPosts(u)}),[u]),c.a.createElement("div",{className:"spaced"},c.a.createElement("h2",{style:{marginBottom:0}},"Explore"),function(e){if(null!==e&&0!==e.length){var t=c.a.createElement(j.a,{onClick:function(e){e.key===n.MOST_RECENT?i(n.MOST_RECENT):i(n.BY_USER)}},c.a.createElement(j.a.Item,{key:n.MOST_RECENT},"Most Recent"),c.a.createElement(j.a.Item,{key:n.BY_USER},"By User"));return c.a.createElement(c.a.Fragment,null,c.a.createElement(w.a,{overlay:t,trigger:["click"]},c.a.createElement(b.a,{type:"text"},"Sort By ",c.a.createElement(z.a,null))),c.a.createElement("div",{className:"feed"},e.map((function(e,t){return c.a.createElement(k.a,{className:"card",key:t},c.a.createElement(g.a,{className:"image",src:e.images[0].full_src,alt:"hello"}),c.a.createElement(W.a,{title:e.text}))}))))}}(e.posts))}function X(e){var t=Object(r.useState)(""),a=Object(p.a)(t,2),n=(a[0],a[1]);function s(){return(s=Object(l.a)(i.a.mark((function t(a){var r,c,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.email,c=a.password,t.prev=1,t.next=4,e.api.login(r,c);case 4:s=t.sent,e.setAuthToken(s.authorization),t.next=17;break;case 8:t.prev=8,t.t0=t.catch(1),t.t1=t.t0,t.next=t.t1===t.t0 instanceof U?13:t.t1===t.t0 instanceof J?15:17;break;case 13:return n("Login unsuccessful, check your email and password. Did you mean to sign up?"),t.abrupt("break",17);case 15:return n("Our systems seem to be experiencing issues, please try again later"),t.abrupt("break",17);case 17:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}return c.a.createElement("div",{className:"authForm"},c.a.createElement("h2",{className:"spaced"},"Login"),c.a.createElement(d.a,{onFinish:function(e){return s.apply(this,arguments)}},c.a.createElement(d.a.Item,{label:"Email",name:"email"},c.a.createElement(O.a,{required:!0})),c.a.createElement(d.a.Item,{label:"Password",name:"password"},c.a.createElement(O.a.Password,{required:!0})),c.a.createElement("button",null,"Submit")))}function Z(e){var t=Object(r.useState)(""),a=Object(p.a)(t,2),n=(a[0],a[1]);function s(){return(s=Object(l.a)(i.a.mark((function t(a){var r,c,s,o,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.email,c=a.username,s=a.password,t.prev=1,t.next=4,e.api.signup(r,c,s);case 4:o=t.sent,e.setAuthToken(null===(u=o)||void 0===u?void 0:u.authorization),t.next=16;break;case 8:t.prev=8,t.t0=t.catch(1),t.t1=t.t0,t.next=t.t1===t.t0 instanceof L?13:15;break;case 13:return n("Email is already registered, did you mean to log in?"),t.abrupt("break",16);case 15:throw t.t0;case 16:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}return c.a.createElement("div",{className:"authForm"},c.a.createElement("h2",{className:"spaced"},"Sign up"),c.a.createElement(d.a,{onFinish:function(e){return s.apply(this,arguments)}},c.a.createElement(d.a.Item,{label:"Email",name:"email"},c.a.createElement(O.a,null)),c.a.createElement(d.a.Item,{label:"Username",name:"username"},c.a.createElement(O.a,null)),c.a.createElement(d.a.Item,{label:"Password",name:"password"},c.a.createElement(O.a.Password,null)),c.a.createElement("button",null,"Submit")))}!function(e){e.MOST_RECENT="most_recent",e.BY_USER="by_user"}(n||(n={}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[202,1,2]]]);
//# sourceMappingURL=main.2962bd4c.chunk.js.map